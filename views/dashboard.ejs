<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/styles/style.css">
    <title>Dashboard</title>
</head>

<body class="bg-cyan-600 flex flex-col h-screen">

    <div class="container mx-auto p-4 max-w-7xl">

       <div class="flex justify-center items-center space-x-3">
        <div class="mb-4">
            <label for="searchState" class="block text-[#220E24]  font-bold mb-2">Search by State:</label>
            <input type="text" id="searchState" placeholder="Enter state..."
                class="border rounded w-full py-2 px-3 focus:outline-none">
            <div id="stateSuggestions" class="suggestions"></div>
        </div>

        <div class="mb-4">
            <label for="searchCity" class="block text-[#220E24] font-bold mb-2">Search by City:</label>
            <input type="text" id="searchCity" placeholder="Enter city..."
                class="border rounded w-full py-2 px-3 focus:outline-none ">
            <div id="citySuggestions" class="suggestions"></div>
        </div>
       </div>

        <h2 class="text-2xl font-bold mb-4">List of Companies</h2>

        <!-- Loop through registered companies and display them in cards -->
        <% companies.forEach(company => { %>
        <div class="company-card bg-white p-4 rounded-2xl mb-4 shadow-2xl"
            data-company-state="<%= company.state %>" data-company-city="<%= company.city %>">
            <h3 class="text-xl font-bold mb-2"><%= company.companyName %></h3>
            <p><strong>Owner:</strong> <%= company.ownerName %></p>
            <p><strong>GST No:</strong> <%= company.gstNo %></p>
            <p><strong>Address:</strong> <%= company.address %></p>
            <p><strong>State:</strong> <%= company.state %></p>
            <p><strong>City:</strong> <%= company.city %></p>
            <p><strong>Email:</strong> <%= company.email %></p>
            <p><strong>Registration Date:</strong> <%= company.registrationDate.toDateString() %></p>
        </div>
        <% }); %>
    </div>

    <script>
        const searchState = document.getElementById('searchState');
        const searchCity = document.getElementById('searchCity');
        const companyCards = document.querySelectorAll('.company-card');

        searchState.addEventListener('input', filterCompanies);
        searchCity.addEventListener('input', filterCompanies);

        function filterCompanies() {
            const queryState = searchState.value.toLowerCase();
            const queryCity = searchCity.value.toLowerCase();

            companyCards.forEach(companyCard => {
                const companyState = companyCard.getAttribute('data-company-state').toLowerCase();
                const companyCity = companyCard.getAttribute('data-company-city').toLowerCase();

                const stateMatch = queryState === '' || companyState.includes(queryState);
                const cityMatch = queryCity === '' || companyCity.includes(queryCity);

                if (stateMatch && cityMatch) {
                    companyCard.style.display = 'block';
                } else {
                    companyCard.style.display = 'none';
                }
            });
        }
    </script>
</body>

</html>
